# just using interface, and we don't really expect them to use it on 2.x so just skip diffing
#spark2-sql-plugin/src/main/java/com/nvidia/spark/RapidsUDF.java

diff ./sql-plugin/src/main/scala/org/apache/spark/sql/hive/rapids/GpuHiveOverrides.scala spark2-sql-plugin/src/main/scala/org/apache/spark/sql/hive/rapids/GpuHiveOverrides.scala > GpuHiveOverrides.newdiff
if [[ $(diff spark2diffs/GpuHiveOverrides.diff GpuHiveOverrides.newdiff) ]]; then
  echo "check diff for spark2-sql-plugin/src/main/scala/org/apache/spark/sql/hive/rapids/GpuHiveOverrides.scala"
fi

sed -n  '/class GpuBroadcastNestedLoopJoinMeta/,/override def convertToGpu/{/override def convertToGpu/!p}' spark2-sql-plugin/src/main/scala/org/apache/spark/sql/rapids/execution/GpuBroadcastNestedLoopJoinMeta.scala > GpuBroadcastNestedLoopJoinMeta_new.out
sed -n  '/class GpuBroadcastNestedLoopJoinMeta/,/override def convertToGpu/{/override def convertToGpu/!p}' sql-plugin/src/main/scala/org/apache/spark/sql/rapids/execution/GpuBroadcastNestedLoopJoinExec.scala > GpuBroadcastNestedLoopJoinMeta_old.out
diff GpuBroadcastNestedLoopJoinMeta_new.out GpuBroadcastNestedLoopJoinMeta_old.out >  GpuBroadcastNestedLoopJoinMeta.newdiff
diff -c spark2diffs/GpuBroadcastNestedLoopJoinMeta.diff  GpuBroadcastNestedLoopJoinMeta.newdiff

sed -n  '/object JoinTypeChecks/,/def extractTopLevelAttributes/{/def extractTopLevelAttributes/!p}' spark2-sql-plugin/src/main/scala/org/apache/spark/sql/rapids/execution/GpuHashJoin.scala > GpuHashJoin_new.out
sed -n  '/object JoinTypeChecks/,/def extractTopLevelAttributes/{/def extractTopLevelAttributes/!p}' ./sql-plugin/src/main/scala/org/apache/spark/sql/rapids/execution/GpuHashJoin.scala > GpuHashJoin_old.out
diff GpuHashJoin_new.out GpuHashJoin_old.out > GpuHashJoin.newdiff
diff -c spark2diffs/GpuHashJoin.diff GpuHashJoin.newdiff

sed -n  '/class GpuShuffleMeta/,/override def convertToGpu/{/override def convertToGpu/!p}' spark2-sql-plugin/src/main/scala/org/apache/spark/sql/rapids/execution/GpuShuffleMeta.scala > GpuShuffleMeta_new.out
sed -n  '/class GpuShuffleMeta/,/override def convertToGpu/{/override def convertToGpu/!p}' sql-plugin/src/main/scala/org/apache/spark/sql/rapids/execution/GpuShuffleExchangeExecBase.scala > GpuShuffleMeta_old.out
diff GpuShuffleMeta_new.out GpuShuffleMeta_old.out > GpuShuffleMeta.newdiff
diff -c spark2diffs/GpuShuffleMeta.diff GpuShuffleMeta.newdiff

sed -n  '/class GpuBroadcastMeta/,/override def convertToGpu/{/override def convertToGpu/!p}' spark2-sql-plugin/src/main/scala/org/apache/spark/sql/rapids/execution/GpuBroadcastExchangeExecMeta.scala > GpuBroadcastExchangeExecMeta_new.out
sed -n  '/class GpuBroadcastMeta/,/override def convertToGpu/{/override def convertToGpu/!p}' sql-plugin/src/main/scala/org/apache/spark/sql/rapids/execution/GpuBroadcastExchangeExec.scala > GpuBroadcastExchangeExecMeta_old.out
diff GpuBroadcastExchangeExecMeta_new.out GpuBroadcastExchangeExecMeta_old.out > GpuBroadcastExchangeExecMeta.newdiff
diff -c spark2diffs/GpuBroadcastExchangeExecMeta.diff GpuBroadcastExchangeExecMeta.newdiff

sed -n  '/abstract class UnixTimeExprMeta/,/sealed trait TimeParserPolicy/{/sealed trait TimeParserPolicy/!p}' spark2-sql-plugin/src/main/scala/org/apache/spark/sql/rapids/datetimeExpressionsMeta.scala > UnixTimeExprMeta_new.out
sed -n  '/abstract class UnixTimeExprMeta/,/sealed trait TimeParserPolicy/{/sealed trait TimeParserPolicy/!p}' sql-plugin/src/main/scala/org/apache/spark/sql/rapids/datetimeExpressions.scala > UnixTimeExprMeta_old.out
diff UnixTimeExprMeta_new.out UnixTimeExprMeta_old.out > UnixTimeExprMeta.newdiff
diff -c spark2diffs/UnixTimeExprMeta.diff UnixTimeExprMeta.newdiff

sed -n  '/object GpuToTimestamp/,/abstract class UnixTimeExprMeta/{/abstract class UnixTimeExprMeta/!p}' spark2-sql-plugin/src/main/scala/org/apache/spark/sql/rapids/datetimeExpressionsMeta.scala > GpuToTimestamp_new.out
sed -n  '/object GpuToTimestamp/,/val REMOVE_WHITESPACE_FROM_MONTH_DAY/{/val REMOVE_WHITESPACE_FROM_MONTH_DAY/!p}' sql-plugin/src/main/scala/org/apache/spark/sql/rapids/datetimeExpressions.scala > GpuToTimestamp_old.out
diff GpuToTimestamp_new.out GpuToTimestamp_old.out > GpuToTimestamp.newdiff
diff -c spark2diffs/GpuToTimestamp.diff GpuToTimestamp.newdiff

sed -n  '/case class ParseFormatMeta/,/case class RegexReplace/p' spark2-sql-plugin/src/main/scala/org/apache/spark/sql/rapids/datetimeExpressionsMeta.scala > datemisc_new.out
sed -n  '/case class ParseFormatMeta/,/case class RegexReplace/p' sql-plugin/src/main/scala/org/apache/spark/sql/rapids/datetimeExpressions.scala > datemisc_old.out
diff -c datemisc_new.out datemisc_old.out

sed -n  '/class GpuRLikeMeta/,/^}/{/^}/!p}' spark2-sql-plugin/src/main/scala/org/apache/spark/sql/rapids/stringMeta.scala > GpuRLikeMeta_new.out
sed -n  '/class GpuRLikeMeta/,/override def convertToGpu/{/override def convertToGpu/!p}' sql-plugin/src/main/scala/org/apache/spark/sql/rapids/stringFunctions.scala > GpuRLikeMeta_old.out
diff GpuRLikeMeta_new.out GpuRLikeMeta_old.out > GpuRLikeMeta.newdiff
diff -c spark2diffs/GpuRLikeMeta.diff  GpuRLikeMeta.newdiff

sed -n  '/class GpuRegExpExtractMeta/,/^}/{/^}/!p}' spark2-sql-plugin/src/main/scala/org/apache/spark/sql/rapids/stringMeta.scala > GpuRegExpExtractMeta_new.out
sed -n  '/class GpuRegExpExtractMeta/,/override def convertToGpu/{/override def convertToGpu/!p}' sql-plugin/src/main/scala/org/apache/spark/sql/rapids/stringFunctions.scala > GpuRegExpExtractMeta_old.out
diff GpuRegExpExtractMeta_new.out GpuRegExpExtractMeta_old.out > GpuRegExpExtractMeta.newdiff
diff -c spark2diffs/GpuRegExpExtractMeta.diff  GpuRegExpExtractMeta.newdiff

sed -n  '/class SubstringIndexMeta/,/^}/{/^}/!p}' spark2-sql-plugin/src/main/scala/org/apache/spark/sql/rapids/stringMeta.scala > SubstringIndexMeta_new.out
sed -n  '/class SubstringIndexMeta/,/override def convertToGpu/{/override def convertToGpu/!p}' sql-plugin/src/main/scala/org/apache/spark/sql/rapids/stringFunctions.scala > SubstringIndexMeta_old.out
diff SubstringIndexMeta_new.out SubstringIndexMeta_old.out > SubstringIndexMeta.newdiff
diff -c spark2diffs/SubstringIndexMeta.diff  SubstringIndexMeta.newdiff

sed -n  '/object CudfRegexp/,/^}/{/^}/!p}' spark2-sql-plugin/src/main/scala/org/apache/spark/sql/rapids/stringMeta.scala > CudfRegexp_new.out
sed -n  '/object CudfRegexp/,/^}/{/^}/!p}' sql-plugin/src/main/scala/org/apache/spark/sql/rapids/stringFunctions.scala > CudfRegexp_old.out
diff -c CudfRegexp_new.out CudfRegexp_old.out > CudfRegexp.newdiff

sed -n  '/object GpuSubstringIndex/,/^}/{/^}/!p}' spark2-sql-plugin/src/main/scala/org/apache/spark/sql/rapids/stringMeta.scala > GpuSubstringIndex_new.out
sed -n  '/object GpuSubstringIndex/,/^}/{/^}/!p}' sql-plugin/src/main/scala/org/apache/spark/sql/rapids/stringFunctions.scala > GpuSubstringIndex_old.out
diff -c GpuSubstringIndex_new.out GpuSubstringIndex_old.out > GpuSubstringIndex.newdiff

sed -n  '/class GpuStringSplitMeta/,/^}/{/^}/!p}' spark2-sql-plugin/src/main/scala/org/apache/spark/sql/rapids/stringMeta.scala > GpuStringSplitMeta_new.out
sed -n  '/class GpuStringSplitMeta/,/override def convertToGpu/{/override def convertToGpu/!p}' sql-plugin/src/main/scala/org/apache/spark/sql/rapids/stringFunctions.scala > GpuStringSplitMeta_old.out
diff GpuStringSplitMeta_new.out GpuStringSplitMeta_old.out > GpuStringSplitMeta.newdiff
diff -c spark2diffs/GpuStringSplitMeta.diff  GpuStringSplitMeta.newdiff

sed -n  '/object GpuOrcFileFormat/,/^}/{/^}/!p}' spark2-sql-plugin/src/main/scala/org/apache/spark/sql/rapids/GpuOrcFileFormat.scala > GpuOrcFileFormat_new.out
sed -n  '/object GpuOrcFileFormat/,/^}/{/^}/!p}' sql-plugin/src/main/scala/org/apache/spark/sql/rapids/GpuOrcFileFormat.scala  > GpuOrcFileFormat_old.out
diff  GpuOrcFileFormat_new.out GpuOrcFileFormat_old.out > GpuOrcFileFormat.newdiff
diff -c spark2diffs/GpuOrcFileFormat.diff GpuOrcFileFormat.newdiff

sed -n  '/class GpuSequenceMeta/,/^}/{/^}/!p}' spark2-sql-plugin/src/main/scala/org/apache/spark/sql/rapids/collectionOperations.scala > GpuSequenceMeta_new.out
sed -n  '/class GpuSequenceMeta/,/override def convertToGpu/{/override def convertToGpu/!p}' sql-plugin/src/main/scala/org/apache/spark/sql/rapids/collectionOperations.scala > GpuSequenceMeta_old.out
diff GpuSequenceMeta_new.out GpuSequenceMeta_old.out > GpuSequenceMeta.newdiff
diff -c spark2diffs/GpuSequenceMeta.diff  GpuSequenceMeta.newdiff

sed -n  '/object GpuDataSource/,/^}/{/^}/!p}' spark2-sql-plugin/src/main/scala/org/apache/spark/sql/rapids/GpuDataSource.scala > GpuDataSource_new.out
sed -n  '/object GpuDataSource/,/val GLOB_PATHS_KEY/{/val GLOB_PATHS_KEY/!p}' sql-plugin/src/main/scala/org/apache/spark/sql/rapids/GpuDataSource.scala > GpuDataSource_old.out
diff  GpuDataSource_new.out GpuDataSource_old.out > GpuDataSource.newdiff
diff -c spark2diffs/GpuDataSource.diff GpuDataSource.newdiff

sed -n  '/class GpuGetArrayItemMeta/,/^}/{/^}/!p}' spark2-sql-plugin/src/main/scala/org/apache/spark/sql/rapids/complexTypeExtractors.scala  > GpuGetArrayItemMeta_new.out
sed -n  '/class GpuGetArrayItemMeta/,/override def convertToGpu/{/override def convertToGpu/!p}' sql-plugin/src/main/scala/org/apache/spark/sql/rapids/complexTypeExtractors.scala > GpuGetArrayItemMeta_old.out
diff GpuGetArrayItemMeta_new.out GpuGetArrayItemMeta_old.out > GpuGetArrayItemMeta.newdiff
diff -c spark2diffs/GpuGetArrayItemMeta.diff  GpuGetArrayItemMeta.newdiff

sed -n  '/class GpuGetMapValueMeta/,/^}/{/^}/!p}' spark2-sql-plugin/src/main/scala/org/apache/spark/sql/rapids/complexTypeExtractors.scala  > GpuGetMapValueMeta_new.out
sed -n  '/class GpuGetMapValueMeta/,/override def convertToGpu/{/override def convertToGpu/!p}' sql-plugin/src/main/scala/org/apache/spark/sql/rapids/complexTypeExtractors.scala > GpuGetMapValueMeta_old.out
diff GpuGetMapValueMeta_new.out GpuGetMapValueMeta_old.out > GpuGetMapValueMeta.newdiff
diff -c spark2diffs/GpuGetMapValueMeta.diff  GpuGetMapValueMeta.newdiff

sed -n  '/abstract class ScalaUDFMetaBase/,/^}/{/^}/!p}' spark2-sql-plugin/src/main/scala/org/apache/spark/sql/rapids/GpuScalaUDFMeta.scala> ScalaUDFMetaBase_new.out
sed -n  '/abstract class ScalaUDFMetaBase/,/override def convertToGpu/{/override def convertToGpu/!p}' sql-plugin/src/main/scala/org/apache/spark/sql/rapids/GpuScalaUDF.scala > ScalaUDFMetaBase_old.out
diff ScalaUDFMetaBase_new.out ScalaUDFMetaBase_old.out > ScalaUDFMetaBase.newdiff
diff -c spark2diffs/ScalaUDFMetaBase.diff  ScalaUDFMetaBase.newdiff

sed -n  '/object GpuScalaUDF/,/^}/{/^}/!p}' spark2-sql-plugin/src/main/scala/org/apache/spark/sql/rapids/GpuScalaUDFMeta.scala > GpuScalaUDF_new.out
sed -n  '/object GpuScalaUDF/,/^}/{/^}/!p}' sql-plugin/src/main/scala/org/apache/spark/sql/rapids/GpuScalaUDF.scala > GpuScalaUDF_old.out
diff  -c GpuScalaUDF_new.out GpuScalaUDF_old.out > GpuScalaUDF.newdiff

sed -n  '/object GpuDecimalMultiply/,/^}/{/^}/!p}' spark2-sql-plugin/src/main/scala/org/apache/spark/sql/rapids/arithmetic.scala > GpuDecimalMultiply_new.out
sed -n  '/object GpuDecimalMultiply/,/def checkForOverflow/{/def checkForOverflow/!p}' sql-plugin/src/main/scala/org/apache/spark/sql/rapids/arithmetic.scala > GpuDecimalMultiply_old.out
diff  GpuDecimalMultiply_new.out GpuDecimalMultiply_old.out > GpuDecimalMultiply.newdiff
diff -c spark2diffs/GpuDecimalMultiply.diff GpuDecimalMultiply.newdiff

sed -n  '/object GpuDecimalDivide/,/^}/{/^}/!p}' spark2-sql-plugin/src/main/scala/org/apache/spark/sql/rapids/arithmetic.scala > GpuDecimalDivide_new.out
sed -n  '/object GpuDecimalDivide/,/^}/{/^}/!p}' sql-plugin/src/main/scala/org/apache/spark/sql/rapids/arithmetic.scala > GpuDecimalDivide_old.out
diff  GpuDecimalDivide_new.out GpuDecimalDivide_old.out > GpuDecimalDivide.newdiff
diff -c spark2diffs/GpuDecimalDivide.diff GpuDecimalDivide.newdiff

sed -n  '/def isSupportedRelation/,/^  }/{/^  }/!p}' spark2-sql-plugin/src/main/scala/org/apache/spark/TrampolineUtil.scala > isSupportedRelation_new.out
sed -n  '/def isSupportedRelation/,/^  }/{/^  }/!p}' sql-plugin/src/main/scala/org/apache/spark/sql/rapids/execution/TrampolineUtil.scala > isSupportedRelation_old.out
diff  -c isSupportedRelation_new.out isSupportedRelation_old.out 

sed -n  '/def dataTypeExistsRecursively/,/^  }/{/^  }/!p}' spark2-sql-plugin/src/main/scala/org/apache/spark/TrampolineUtil.scala > dataTypeExistsRecursively_new.out
sed -n  '/def dataTypeExistsRecursively/,/^  }/{/^  }/!p}' sql-plugin/src/main/scala/org/apache/spark/sql/rapids/execution/TrampolineUtil.scala > dataTypeExistsRecursively_old.out
diff  -c dataTypeExistsRecursively_new.out dataTypeExistsRecursively_old.out 

sed -n  '/def getSimpleName/,/^  }/{/^  }/!p}' spark2-sql-plugin/src/main/scala/org/apache/spark/TrampolineUtil.scala > getSimpleName_new.out
sed -n  '/def getSimpleName/,/^  }/{/^  }/!p}' sql-plugin/src/main/scala/org/apache/spark/sql/rapids/execution/TrampolineUtil.scala > getSimpleName_old.out
diff  -c getSimpleName_new.out getSimpleName_old.out 

diff ./spark2-sql-plugin/src/main/scala/com/nvidia/spark/rapids/RegexParser.scala ./sql-plugin/src/main/scala/com/nvidia/spark/rapids/RegexParser.scala > RegexParser.newdiff
diff -c spark2diffs/RegexParser.diff RegexParser.newdiff

diff ./spark2-sql-plugin/src/main/scala/com/nvidia/spark/rapids/TypeChecks.scala ./sql-plugin/src/main/scala/com/nvidia/spark/rapids/TypeChecks.scala > TypeChecks.newdiff
diff -c spark2diffs/TypeChecks.diff  TypeChecks.newdiff

diff spark2-sql-plugin/src/main/scala/com/nvidia/spark/rapids/DataTypeUtils.scala ./sql-plugin/src/main/scala/com/nvidia/spark/rapids/DataTypeUtils.scala > DataTypeUtils.newdiff
diff -c spark2diffs/DataTypeUtils.diff DataTypeUtils.newdiff

#TODO
spark2-sql-plugin/src/main/scala/com/nvidia/spark/rapids/GpuOverrides.scala
## TODO

sed -n  '/object GpuOrcScanBase/,/^}/{/^}/!p}' spark2-sql-plugin/src/main/scala/com/nvidia/spark/rapids/GpuOrcScanBase.scala > GpuOrcScanBase_new.out
sed -n  '/object GpuOrcScanBase/,/^}/{/^}/!p}' ./sql-plugin/src/main/scala/com/nvidia/spark/rapids/GpuOrcScanBase.scala > GpuOrcScanBase_old.out
diff  GpuOrcScanBase_new.out GpuOrcScanBase_old.out > GpuOrcScanBase.newdiff
diff -c spark2diffs/GpuOrcScanBase.diff GpuOrcScanBase.newdiff

sed -n  '/class LiteralExprMeta/,/^}/{/^}/!p}' spark2-sql-plugin/src/main/scala/com/nvidia/spark/rapids/literalsMeta.scala > LiteralExprMeta_new.out
sed -n  '/class LiteralExprMeta/,/^}/{/^}/!p}' sql-plugin/src/main/scala/com/nvidia/spark/rapids/literals.scala > LiteralExprMeta_old.out
diff  LiteralExprMeta_new.out LiteralExprMeta_old.out > LiteralExprMeta.newdiff
diff -c spark2diffs/LiteralExprMeta.diff LiteralExprMeta.newdiff

# 2.x doesn't have a base aggregate class so this is much different, check the revision for now
CUR_COMMIT=`git log -1 sql-plugin/src/main/scala/com/nvidia/spark/rapids/aggregate.scala | grep commit | cut -d ' ' -f 2`
if [ "$CUR_COMMIT" != "b17c685788c0a62763aa8101709e241877f02025" ]; then
    echo "sql-plugin/src/main/scala/com/nvidia/spark/rapids/aggregate.scala has different commit - check manually"
fi

sed -n  '/class GpuGenerateExecSparkPlanMeta/,/^}/{/^}/!p}' spark2-sql-plugin/src/main/scala/com/nvidia/spark/rapids/GpuGenerateExecMeta.scala > GpuGenerateExecSparkPlanMeta_new.out
sed -n  '/class GpuGenerateExecSparkPlanMeta/,/override def convertToGpu/{/override def convertToGpu/!p}' sql-plugin/src/main/scala/com/nvidia/spark/rapids/GpuGenerateExec.scala > GpuGenerateExecSparkPlanMeta_old.out
diff GpuGenerateExecSparkPlanMeta_new.out GpuGenerateExecSparkPlanMeta_old.out > GpuGenerateExecSparkPlanMeta.newdiff
diff -c spark2diffs/GpuGenerateExecSparkPlanMeta.diff  GpuGenerateExecSparkPlanMeta.newdiff

sed -n  '/abstract class GeneratorExprMeta/,/^}/{/^}/!p}' spark2-sql-plugin/src/main/scala/com/nvidia/spark/rapids/GpuGenerateExecMeta.scala > GeneratorExprMeta_new.out
sed -n  '/abstract class GeneratorExprMeta/,/^}/{/^}/!p}' sql-plugin/src/main/scala/com/nvidia/spark/rapids/GpuGenerateExec.scala > GeneratorExprMeta_old.out
diff GeneratorExprMeta_new.out GeneratorExprMeta_old.out > GeneratorExprMeta.newdiff
diff -c spark2diffs/GeneratorExprMeta.diff  GeneratorExprMeta.newdiff

diff ./spark2-sql-plugin/src/main/scala/com/nvidia/spark/rapids/ExplainPlan.scala ./sql-plugin/src/main/scala/com/nvidia/spark/rapids/ExplainPlan.scala > ExplainPlan.newdiff
diff spark2diffs/ExplainPlan.diff ExplainPlan.newdiff

sed -n  '/class GpuProjectExecMeta/,/^}/{/^}/!p}' spark2-sql-plugin/src/main/scala/com/nvidia/spark/rapids/basicPhysicalOperatorsMeta.scala > GpuProjectExecMeta_new.out
sed -n  '/class GpuProjectExecMeta/,/override def convertToGpu/{/override def convertToGpu/!p}' sql-plugin/src/main/scala/com/nvidia/spark/rapids/basicPhysicalOperators.scala > GpuProjectExecMeta_old.out
diff GpuProjectExecMeta_new.out GpuProjectExecMeta_old.out > GpuProjectExecMeta.newdiff
diff -c spark2diffs/GpuProjectExecMeta.diff  GpuProjectExecMeta.newdiff

sed -n  '/class GpuSortMeta/,/^}/{/^}/!p}' spark2-sql-plugin/src/main/scala/com/nvidia/spark/rapids/GpuSortExecMeta.scala > GpuSortMeta_new.out
sed -n  '/class GpuSortMeta/,/override def convertToGpu/{/override def convertToGpu/!p}' sql-plugin/src/main/scala/com/nvidia/spark/rapids/GpuSortExec.scala > GpuSortMeta_old.out
diff GpuSortMeta_new.out GpuSortMeta_old.out > GpuSortMeta.newdiff
diff -c spark2diffs/GpuSortMeta.diff  GpuSortMeta.newdiff

diff ./spark2-sql-plugin/src/main/scala/com/nvidia/spark/rapids/InputFileBlockRule.scala ./sql-plugin/src/main/scala/com/nvidia/spark/rapids/InputFileBlockRule.scala > InputFileBlockRule.newdiff
diff -c spark2diffs/InputFileBlockRule.diff InputFileBlockRule.newdiff

sed -n  '/abstract class GpuWindowInPandasExecMetaBase/,/^}/{/^}/!p}' spark2-sql-plugin/src/main/scala/com/nvidia/spark/rapids/shims/v2/gpuPandasMeta.scala > GpuWindowInPandasExecMetaBase_new.out
sed -n  '/abstract class GpuWindowInPandasExecMetaBase/,/^}/{/^}/!p}' sql-plugin/src/main/scala/org/apache/spark/sql/rapids/execution/python/GpuWindowInPandasExecBase.scala > GpuWindowInPandasExecMetaBase_old.out
diff GpuWindowInPandasExecMetaBase_new.out GpuWindowInPandasExecMetaBase_old.out > GpuWindowInPandasExecMetaBase.newdiff
diff -c spark2diffs/GpuWindowInPandasExecMetaBase.diff  GpuWindowInPandasExecMetaBase.newdiff

sed -n  '/class GpuAggregateInPandasExecMeta/,/^}/{/^}/!p}' spark2-sql-plugin/src/main/scala/com/nvidia/spark/rapids/shims/v2/gpuPandasMeta.scala > GpuAggregateInPandasExecMeta_new.out
sed -n  '/class GpuAggregateInPandasExecMeta/,/override def convertToGpu/{/override def convertToGpu/!p}' sql-plugin/src/main/scala/org/apache/spark/sql/rapids/execution/python/GpuAggregateInPandasExec.scala > GpuAggregateInPandasExecMeta_old.out
diff GpuAggregateInPandasExecMeta_new.out GpuAggregateInPandasExecMeta_old.out > GpuAggregateInPandasExecMeta.newdiff
diff -c spark2diffs/GpuAggregateInPandasExecMeta.diff  GpuAggregateInPandasExecMeta.newdiff

sed -n  '/class GpuShuffledHashJoinMeta/,/^}/{/^}/!p}' spark2-sql-plugin/src/main/scala/com/nvidia/spark/rapids/shims/v2/GpuShuffledHashJoinExecMeta.scala > GpuShuffledHashJoinMeta_new.out
sed -n  '/class GpuShuffledHashJoinMeta/,/override def convertToGpu/{/override def convertToGpu/!p}' sql-plugin/src/main/scala/com/nvidia/spark/rapids/GpuShuffledHashJoinExec.scala > GpuShuffledHashJoinMeta_old.out
diff GpuShuffledHashJoinMeta_new.out GpuShuffledHashJoinMeta_old.out > GpuShuffledHashJoinMeta.newdiff
diff -c spark2diffs/GpuShuffledHashJoinMeta.diff  GpuShuffledHashJoinMeta.newdiff

diff ./spark2-sql-plugin/src/main/scala/com/nvidia/spark/rapids/shims/v2/TreeNode.scala ./sql-plugin/src/main/pre320-treenode/scala/com/nvidia/spark/rapids/shims/v2/TreeNode.scala > TreeNode.newdiff
diff -c spark2diffs/TreeNode.diff TreeNode.newdiff

diff spark2-sql-plugin/src/main/scala/com/nvidia/spark/rapids/shims/v2/GpuSortMergeJoinMeta.scala sql-plugin/src/main/scala/com/nvidia/spark/rapids/GpuSortMergeJoinMeta.scala > GpuSortMergeJoinMeta.newdiff
diff -c spark2diffs/GpuSortMergeJoinMeta.diff GpuSortMergeJoinMeta.newdiff

diff spark2-sql-plugin/src/main/scala/com/nvidia/spark/rapids/shims/v2/GpuJoinUtils.scala sql-plugin/src/main/301db/scala/com/nvidia/spark/rapids/shims/v2/GpuJoinUtils.scala > GpuJoinUtils.newdiff
diff -c spark2diffs/GpuJoinUtils.diff GpuJoinUtils.newdiff

diff ./spark2-sql-plugin/src/main/scala/com/nvidia/spark/rapids/shims/v2/TypeSigUtil.scala ./sql-plugin/src/main/301until320-all/scala/com/nvidia/spark/rapids/shims/v2/TypeSigUtil.scala > TypeSigUtil.newdiff
diff -c spark2diffs/TypeSigUtil.diff TypeSigUtil.newdiff

sed -n  '/class GpuBroadcastHashJoinMeta/,/^}/{/^}/!p}' spark2-sql-plugin/src/main/scala/com/nvidia/spark/rapids/shims/v2/GpuBroadcastHashJoinExecMeta.scala > GpuBroadcastHashJoinMeta_new.out
sed -n  '/class GpuBroadcastHashJoinMeta/,/override def convertToGpu/{/override def convertToGpu/!p}' sql-plugin/src/main/scala/com/nvidia/spark/rapids/GpuBroadcastHashJoinExec.scala > GpuBroadcastHashJoinMeta_old.out
diff GpuBroadcastHashJoinMeta_new.out GpuBroadcastHashJoinMeta_old.out > GpuBroadcastHashJoinMeta.newdiff
diff -c spark2diffs/GpuBroadcastHashJoinMeta.diff  GpuBroadcastHashJoinMeta.newdiff

sed -n  '/object GpuCSVScan/,/^}/{/^}/!p}' spark2-sql-plugin/src/main/scala/com/nvidia/spark/rapids/shims/v2/GpuCSVScan.scala > GpuCSVScan_new.out
sed -n  '/object GpuCSVScan/,/^}/{/^}/!p}' sql-plugin/src/main/scala/com/nvidia/spark/rapids/GpuBatchScanExec.scala > GpuCSVScan_old.out
diff  GpuCSVScan_new.out GpuCSVScan_old.out  > GpuCSVScan.newdiff
diff -c spark2diffs/GpuCSVScan.diff GpuCSVScan.newdiff

diff ./spark2-sql-plugin/src/main/scala/com/nvidia/spark/rapids/shims/v2/OffsetWindowFunctionMeta.scala ./sql-plugin/src/main/301until310-all/scala/com/nvidia/spark/rapids/shims/v2/OffsetWindowFunctionMeta.scala > OffsetWindowFunctionMeta.newdiff
diff -c spark2diffs/OffsetWindowFunctionMeta.diff OffsetWindowFunctionMeta.newdiff

sed -n  '/class GpuRegExpReplaceMeta/,/^}/{/^}/!p}' spark2-sql-plugin/src/main/scala/com/nvidia/spark/rapids/shims/v2/GpuRegExpReplaceMeta.scala > GpuRegExpReplaceMeta_new.out
sed -n  '/class GpuRegExpReplaceMeta/,/override def convertToGpu/{/override def convertToGpu/!p}' sql-plugin/src/main/301until310-nondb/scala/com/nvidia/spark/rapids/shims/v2/GpuRegExpReplaceMeta.scala > GpuRegExpReplaceMeta_old.out
diff GpuRegExpReplaceMeta_new.out GpuRegExpReplaceMeta_old.out > GpuRegExpReplaceMeta.newdiff
diff -c spark2diffs/GpuRegExpReplaceMeta.diff  GpuRegExpReplaceMeta.newdiff

sed -n  '/class GpuWindowExpressionMetaBase/,/^}/{/^}/!p}' spark2-sql-plugin/src/main/scala/com/nvidia/spark/rapids/shims/v2/gpuWindows.scala > GpuWindowExpressionMetaBase_new.out
sed -n  '/class GpuWindowExpressionMetaBase/,/override def convertToGpu/{/override def convertToGpu/!p}' sql-plugin/src/main/scala/com/nvidia/spark/rapids/GpuWindowExpression.scala > GpuWindowExpressionMetaBase_old.out
diff GpuWindowExpressionMetaBase_new.out GpuWindowExpressionMetaBase_old.out > GpuWindowExpressionMetaBase.newdiff
diff -c spark2diffs/GpuWindowExpressionMetaBase.diff  GpuWindowExpressionMetaBase.newdiff

sed -n  '/abstract class GpuSpecifiedWindowFrameMetaBase/,/^}/{/^}/!p}' spark2-sql-plugin/src/main/scala/com/nvidia/spark/rapids/shims/v2/gpuWindows.scala > GpuSpecifiedWindowFrameMetaBase_new.out
sed -n  '/abstract class GpuSpecifiedWindowFrameMetaBase/,/override def convertToGpu/{/override def convertToGpu/!p}' sql-plugin/src/main/scala/com/nvidia/spark/rapids/GpuWindowExpression.scala > GpuSpecifiedWindowFrameMetaBase_old.out
diff GpuSpecifiedWindowFrameMetaBase_new.out GpuSpecifiedWindowFrameMetaBase_old.out > GpuSpecifiedWindowFrameMetaBase.newdiff
diff -c spark2diffs/GpuSpecifiedWindowFrameMetaBase.diff  GpuSpecifiedWindowFrameMetaBase.newdiff

sed -n  '/class GpuSpecifiedWindowFrameMeta(/,/^}/{/^}/!p}' spark2-sql-plugin/src/main/scala/com/nvidia/spark/rapids/shims/v2/gpuWindows.scala > GpuSpecifiedWindowFrameMeta_new.out
sed -n  '/class GpuSpecifiedWindowFrameMeta(/,/^}/{/^}/!p}' sql-plugin/src/main/301until320-all/scala/com/nvidia/spark/rapids/shims/v2/gpuWindows.scala > GpuSpecifiedWindowFrameMeta_old.out
diff GpuSpecifiedWindowFrameMeta_new.out GpuSpecifiedWindowFrameMeta_old.out > GpuSpecifiedWindowFrameMeta.newdiff
diff -c spark2diffs/GpuSpecifiedWindowFrameMeta.diff  GpuSpecifiedWindowFrameMeta.newdiff

sed -n  '/class GpuWindowExpressionMeta(/,/^}/{/^}/!p}' spark2-sql-plugin/src/main/scala/com/nvidia/spark/rapids/shims/v2/gpuWindows.scala > GpuWindowExpressionMeta_new.out
sed -n  '/class GpuWindowExpressionMeta(/,/^}/{/^}/!p}' sql-plugin/src/main/301until320-all/scala/com/nvidia/spark/rapids/shims/v2/gpuWindows.scala > GpuWindowExpressionMeta_old.out
diff GpuWindowExpressionMeta_new.out GpuWindowExpressionMeta_old.out > GpuWindowExpressionMeta.newdiff
diff -c spark2diffs/GpuWindowExpressionMeta.diff  GpuWindowExpressionMeta.newdiff

sed -n  '/object GpuWindowUtil/,/^}/{/^}/!p}' spark2-sql-plugin/src/main/scala/com/nvidia/spark/rapids/shims/v2/gpuWindows.scala > GpuWindowUtil_new.out
sed -n  '/object GpuWindowUtil/,/^}/{/^}/!p}' sql-plugin/src/main/301until320-all/scala/com/nvidia/spark/rapids/shims/v2/gpuWindows.scala > GpuWindowUtil_old.out
diff  -c GpuWindowUtil_new.out GpuWindowUtil_old.out

sed -n  '/case class ParsedBoundary/p' spark2-sql-plugin/src/main/scala/com/nvidia/spark/rapids/shims/v2/gpuWindows.scala > ParsedBoundary_new.out
sed -n  '/case class ParsedBoundary/p' sql-plugin/src/main/scala/com/nvidia/spark/rapids/GpuWindowExec.scala > ParsedBoundary_old.out
diff -c ParsedBoundary_new.out ParsedBoundary_old.out

sed -n  '/class GpuWindowSpecDefinitionMeta/,/^}/{/^}/!p}' spark2-sql-plugin/src/main/scala/com/nvidia/spark/rapids/shims/v2/gpuWindows.scala > GpuWindowSpecDefinitionMeta_new.out
sed -n  '/class GpuWindowSpecDefinitionMeta/,/override def convertToGpu/{/override def convertToGpu/!p}' sql-plugin/src/main/scala/com/nvidia/spark/rapids/GpuWindowExpression.scala > GpuWindowSpecDefinitionMeta_old.out
diff GpuWindowSpecDefinitionMeta_new.out GpuWindowSpecDefinitionMeta_old.out > GpuWindowSpecDefinitionMeta.newdiff
diff -c spark2diffs/GpuWindowSpecDefinitionMeta.diff  GpuWindowSpecDefinitionMeta.newdiff

sed -n  '/abstract class GpuBaseWindowExecMeta/,/^}/{/^}/!p}' spark2-sql-plugin/src/main/scala/com/nvidia/spark/rapids/GpuWindowMeta.scala > GpuBaseWindowExecMeta_new.out
sed -n  '/abstract class GpuBaseWindowExecMeta/,/override def convertToGpu/{/override def convertToGpu/!p}' sql-plugin/src/main/scala/com/nvidia/spark/rapids/GpuWindowExec.scala > GpuBaseWindowExecMeta_old.out
diff GpuBaseWindowExecMeta_new.out GpuBaseWindowExecMeta_old.out > GpuBaseWindowExecMeta.newdiff
diff -c spark2diffs/GpuBaseWindowExecMeta.diff GpuBaseWindowExecMeta.newdiff

sed -n  '/class GpuWindowExecMeta(/,/^}/{/^}/!p}' spark2-sql-plugin/src/main/scala/com/nvidia/spark/rapids/GpuWindowMeta.scala > GpuWindowExecMeta_new.out
sed -n  '/class GpuWindowExecMeta(/,/^}/{/^}/!p}' sql-plugin/src/main/scala/com/nvidia/spark/rapids/GpuWindowExec.scala  > GpuWindowExecMeta_old.out
diff GpuWindowExecMeta_new.out GpuWindowExecMeta_old.out > GpuWindowExecMeta.newdiff
diff -c spark2diffs/GpuWindowExecMeta.diff  GpuWindowExecMeta.newdiff

sed -n  '/class GpuExpandExecMeta/,/^}/{/^}/!p}' spark2-sql-plugin/src/main/scala/com/nvidia/spark/rapids/GpuExpandMeta.scala > GpuExpandExecMeta_new.out
sed -n  '/class GpuExpandExecMeta/,/override def convertToGpu/{/override def convertToGpu/!p}' sql-plugin/src/main/scala/com/nvidia/spark/rapids/GpuExpandExec.scala > GpuExpandExecMeta_old.out
diff GpuExpandExecMeta_new.out GpuExpandExecMeta_old.out > GpuExpandExecMeta.newdiff
diff -c spark2diffs/GpuExpandExecMeta.diff GpuExpandExecMeta.newdiff

diff ./spark2-sql-plugin/src/main/scala/com/nvidia/spark/rapids/RapidsMeta.scala ./sql-plugin/src/main/scala/com/nvidia/spark/rapids/RapidsMeta.scala > RapidsMeta.newdiff
diff -c spark2diffs/RapidsMeta.diff RapidsMeta.newdiff

sed -n  '/object GpuReadCSVFileFormat/,/^}/{/^}/!p}' spark2-sql-plugin/src/main/scala/com/nvidia/spark/rapids/GpuReadCSVFileFormat.scala > GpuReadCSVFileFormat_new.out
sed -n  '/object GpuReadCSVFileFormat/,/^}/{/^}/!p}' sql-plugin/src/main/scala/com/nvidia/spark/rapids/GpuReadCSVFileFormat.scala > GpuReadCSVFileFormat_old.out
diff  GpuReadCSVFileFormat_new.out GpuReadCSVFileFormat_old.out > GpuReadCSVFileFormat.newdiff
diff -c spark2diffs/GpuReadCSVFileFormat.diff GpuReadCSVFileFormat.newdiff 

diff ./spark2-sql-plugin/src/main/scala/com/nvidia/spark/rapids/RapidsConf.scala ./sql-plugin/src/main/scala/com/nvidia/spark/rapids/RapidsConf.scala > RapidsConf.newdiff
diff -c spark2diffs/RapidsConf.diff RapidsConf.newdiff

sed -n  '/object GpuReadParquetFileFormat/,/^}/{/^}/!p}' spark2-sql-plugin/src/main/scala/com/nvidia/spark/rapids/GpuParquetScanBase.scala > GpuReadParquetFileFormat_new.out
sed -n  '/object GpuReadParquetFileFormat/,/^}/{/^}/!p}' sql-plugin/src/main/scala/com/nvidia/spark/rapids/GpuReadParquetFileFormat.scala > GpuReadParquetFileFormat_old.out
diff  GpuReadParquetFileFormat_new.out GpuReadParquetFileFormat_old.out > GpuReadParquetFileFormat.newdiff
diff -c spark2diffs/GpuReadParquetFileFormat.diff GpuReadParquetFileFormat.newdiff

sed -n  '/object GpuParquetScanBase/,/^}/{/^}/!p}' spark2-sql-plugin/src/main/scala/com/nvidia/spark/rapids/GpuParquetScanBase.scala > GpuParquetScanBase_new.out
sed -n  '/object GpuParquetScanBase/,/^}/{/^}/!p}' sql-plugin/src/main/scala/com/nvidia/spark/rapids/GpuParquetScanBase.scala > GpuParquetScanBase_old.out
diff  GpuParquetScanBase_new.out GpuParquetScanBase_old.out > GpuParquetScanBase.newdiff
diff -c spark2diffs/GpuParquetScanBase.diff GpuParquetScanBase.newdiff

diff spark2-sql-plugin/src/main/scala/com/nvidia/spark/rapids/GpuBroadcastJoinMeta.scala sql-plugin/src/main/scala/com/nvidia/spark/rapids/GpuBroadcastJoinMeta.scala > GpuBroadcastJoinMeta.newdiff
diff -c spark2diffs/GpuBroadcastJoinMeta.diff GpuBroadcastJoinMeta.newdiff

sed -n  '/object AggregateUtils/,/^}/{/^}/!p}' spark2-sql-plugin/src/main/scala/com/nvidia/spark/rapids/AggregateUtils.scala > AggregateUtils_new.out
sed -n  '/object AggregateUtils/,/^}/{/^}/!p}' sql-plugin/src/main/scala/com/nvidia/spark/rapids/aggregate.scala > AggregateUtils_old.out
diff  AggregateUtils_new.out AggregateUtils_old.out > AggregateUtils.newdiff
diff -c spark2diffs/AggregateUtils.diff AggregateUtils.newdiff

sed -n  '/final class CastExprMeta/,/^}/{/^}/!p}' spark2-sql-plugin/src/main/scala/com/nvidia/spark/rapids/GpuCastMeta.scala > CastExprMeta_new.out
sed -n  '/final class CastExprMeta/,/override def convertToGpu/{/override def convertToGpu/!p}' sql-plugin/src/main/scala/com/nvidia/spark/rapids/GpuCast.scala > CastExprMeta_old.out
diff CastExprMeta_new.out CastExprMeta_old.out > CastExprMeta.newdiff
diff -c spark2diffs/CastExprMeta.diff CastExprMeta.newdiff

sed -n  '/object GpuReadOrcFileFormat/,/^}/{/^}/!p}' spark2-sql-plugin/src/main/scala/com/nvidia/spark/rapids/GpuReadOrcFileFormat.scala > GpuReadOrcFileFormat_new.out
sed -n  '/object GpuReadOrcFileFormat/,/^}/{/^}/!p}' sql-plugin/src/main/scala/com/nvidia/spark/rapids/GpuReadOrcFileFormat.scala > GpuReadOrcFileFormat_old.out
diff  GpuReadOrcFileFormat_new.out GpuReadOrcFileFormat_old.out > GpuReadOrcFileFormat.newdiff
diff -c spark2diffs/GpuReadOrcFileFormat.diff GpuReadOrcFileFormat.newdiff



spark2-sql-plugin/src/main/scala/com/nvidia/spark/rapids/GpuParquetFileFormat.scala
spark2-sql-plugin/src/main/scala/com/nvidia/spark/rapids/DecimalUtil.scala
odcastHashJoinExecMeta.scalapark2-sql-plugin/src/main/scala/com/nvidia/spark/rapids/GpuReplicateRowsMeta.scala
spark2-sql-plugin/src/main/scala/com/nvidia/spark/rapids/DateUtils.scala
